<!doctype html>
<html lang="en">

<head>
	<title>Todo List Project</title>
	<meta charset="utf-8">
	
	<style>
	body {
	background-color: #FAECA9
	}
	
	.topBar {
		font-family: sans-serif;
		font-size: 1em;
		text-align: center;
		color: white;
		position: fixed;
		top:-3%;
		left:0%;
		z-parentListIndex: 100;
		width: 100%;
		height: 10%;
		background-color: #8E2EC2;
	}
	.lists {
		font-family: sans-serif;
		font-size: 1.5em;
		top: 5%;
		margin-left: 10%;
		margin-right: 20%;
		margin-top: 5%;
	
	}
	.form {
		color: #FF8000;
		font-size: 0.5em;
	}
	
	</style>
	
</head>


<body>
	<div class= topBar>
		<h1>Sean's To-do List</h1> 
	</div>
	
	<div class= lists>
		<ul class= listLevel1> 
		</ul>
	</div>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>	
		//CONSTRUCTORS
        var icon = function(alt, src, width, opacity) {
			this.name = name;
			this.src = src;
			this.width = width;
			this.opacity = opacity;
		}
		
		var form = function(parentListIndex) {
			this.button = $("<button>").attr("type", "submit").text("submit");
			this.input = $("<input>").attr("type", "string");
			this.label = $("<label>").append("Add an item <br>").append(this.input);
			this.parentListIndex = parentListIndex;
		}
		
		var inputAnswer;
		var parentListIndex = 0;
		//var mainForm;
		//var subForm;
			
		//INSTANTIATION
		var addIcon = new icon("add", "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678092-sign-add-128.png", "30px", 1)
		
		var $mainListAddIcon = $("<img>")
			.attr("src", addIcon.src)
			.attr("alt", addIcon.alt)
			.attr("width", addIcon.width) 
			.on("click", function(event) {
					console.log("clicked add mainlist");
					$mainForm.appendTo(".listLevel1");
					$mainListAddIcon.appendTo(".listLevel1");
				}
			);
			
		
		var mainForm = new form(0);
		var $mainForm = $("<form>").attr("class", "form").append(mainForm.label).append(mainForm.button)
			.on("submit", function(event) {
				event.preventDefault();
				console.log("main form submitted");
				inputAnswer = $(this).find("input").val();
				
				//mainListItem is created when the answer is submitted
				makeMainListItem();			
				
				$mainForm.appendTo(".listLevel1");
				$mainListAddIcon.appendTo(".listLevel1");
				console.log("main form and icon regenerated")
				}
			)
			
			
		//prepare a mainListItem with new icons and a blank list
		var makeMainListItem = function(event) {
			var blankList = $("<ul>").attr("class", parentListIndex);
			var blankItem = $("<li>");
			var mainListItemAddIcon = new icon("add" + parentListIndex, "https://cdn0.iconfinder.com/data/icons/small-n-flat/24/678092-sign-add-128.png", "30px") ;
			var $mainListItemAddIcon = $("<img>")
				.attr("src", addIcon.src)
				.attr("alt", addIcon.alt)
				.attr("width", addIcon.width)
				.attr("style", "opacity: 0.1")
				.mouseenter(function(event) {
					console.log("detected mouse over mainListItem add icon");
					this.style.opacity = 1;
					}
				)
				.mouseout(function(event) {
					this.style.opacity = 0.1;
					}
				)
				.on("click", makeSubForm())
			
			//relocate mainForm and addIcon
			$mainForm.appendTo(".listLevel1");
			var mainListItem = blankItem.text(inputAnswer).append($mainListItemAddIcon, blankList);	
			mainListItem.appendTo(".listLevel1");
			console.log("mainList item created. index= " + parentListIndex);
			parentListIndex ++;
		}
			
			
		var makeSubForm = function(event) {
			console.log("clicked add mainListItem");
			//Prepare a subForm which adds a new subListItem item (li) to the appropriate place when submitted
			var subForm = new form(parentListIndex);
			var $subForm = $("<form>").attr("class", "form").append(subForm.label).append(subForm.button)
				.on("submit", makeSubListItem)
			$subForm.appendTo("body");
		}
		
		var makeSubListItem = function(event) {
			event.preventDefault();
			var blankItem = $("<li>")
			console.log(this.parent());
			var indexString = String("." + subForm.parent().parent().class);
			console.log(indexString);
			$(indexString).append($("<li>").text("yeee haw"));
			
			
			//$subForm.appendTo("body"); when add icon is clicked
		}
		
		//make an array for subforms and mainListItemButtons to keep track of their locations. Each mainListItem shud store a corresponding numb
		
		$mainListAddIcon.appendTo(".listLevel1");

    </script>
	
</body>





</html>